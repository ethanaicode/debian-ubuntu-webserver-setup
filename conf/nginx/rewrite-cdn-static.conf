    location / {
        # Try to serve the file directly, return 404 if not found
        try_files $uri =404;
    }

    # Forbidden access to hidden files and sensitive files
    location ~ ^/(\.user.ini|\.htaccess|\.git|\.env|\.svn|\.project|\.ssh|\.DS_Store)
    {
        return 404;
    }

    # Favicon handling
    location = /favicon.ico {
        access_log off;
        log_not_found off;
        expires 30d;
    }

    # Image files with long cache
    location ~* \.(png|jpg|jpeg|gif|webp|svg|ico|bmp|tiff)$ {
        expires 1y;
        access_log off;
        log_not_found off;
        add_header Cache-Control "public, immutable";
        add_header X-Content-Type-Options "nosniff" always;
    }

    # CSS and JavaScript files
    location ~* \.(js|css|woff|woff2|ttf|eot|otf)$ {
        expires 1y;
        access_log off;
        log_not_found off;
        add_header Cache-Control "public, immutable";
    }

    # Software packages and archives
    location ~* \.(exe|msi|dmg|pkg|deb|rpm|zip|tar|gz|7z|rar|apk|app)$ {
        expires 90d;
        access_log on;
        log_not_found on;
        add_header Cache-Control "public";
        add_header Content-Disposition "attachment";
        # Limit download speed if needed (optional, remove comment to enable)
        # limit_rate 10m;
    }

    # Video and audio files
    location ~* \.(mp4|webm|ogg|mp3|wav|flac|aac|m4a|avi|mov|wmv)$ {
        expires 30d;
        access_log off;
        log_not_found off;
        add_header Cache-Control "public";
    }

    # PDF and document files
    location ~* \.(pdf|doc|docx|xls|xlsx|ppt|pptx|txt)$ {
        expires 7d;
        access_log on;
        add_header Cache-Control "public";
        add_header Content-Disposition "inline";
    }

    # robots.txt
    location = /robots.txt {
        allow all;
        log_not_found off;
        access_log off;
        expires 1d;
    }

    # Deny access to sensitive files
    location ~* \.(?:htaccess|git|env|ini|log|sh|sql|conf|bak|swp|old|tmp)$ { 
        deny all;
        return 404;
    }

    # Deny access to common directories
    location ~ ^/(backup|backups|\.backup|db|database|sql|logs|config)/ {
        deny all;
        return 404;
    }

    # Security headers for all responses
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-XSS-Protection "1; mode=block" always;
    add_header Referrer-Policy "no-referrer-when-downgrade" always;
